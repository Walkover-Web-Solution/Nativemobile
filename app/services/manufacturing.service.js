"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var httpWrapper_service_1 = require("./httpWrapper.service");
var core_1 = require("@angular/core");
var catchmanger_1 = require("./catchManager/catchmanger");
var manufacturing_api_1 = require("./apiurls/manufacturing.api");
var general_service_1 = require("./general.service");
var service_config_1 = require("./service.config");
var ManufacturingService = (function () {
    function ManufacturingService(errorHandler, _http, _generalService, config) {
        this.errorHandler = errorHandler;
        this._http = _http;
        this._generalService = _generalService;
        this.config = config;
    }
    /**
     * get manufacturing item details
     * URL:: company/:companyUniqueName/stock/:stockUniqueName/manufacture/:manufacturingUniqueName
     */
    ManufacturingService.prototype.GetManufacturingItem = function (model) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.get(this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.GET.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)).replace(':stockUniqueName', encodeURIComponent(model.stockUniqueName)).replace(':manufacturingUniqueName', model.manufacturingUniqueName))
            .map(function (res) {
            var data = res.json();
            data.queryString = model;
            return data;
        })
            .catch(function (e) { return _this.errorHandler.HandleCatch(e, ''); });
    };
    /**
     * create manufacturing item
     * URL:: company/:companyUniqueName/stock/:stockUniqueName/manufacture
     * get resuest model and stock uniquename
     */
    ManufacturingService.prototype.CreateManufacturingItem = function (model, stockUniqueName) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.post(this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.CREATE.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)).replace(':stockUniqueName', encodeURIComponent(stockUniqueName)), model).map(function (res) {
            var data = res.json();
            data.request = model;
            data.queryString = { stockUniqueName: stockUniqueName };
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e, model); });
    };
    /**
     * Update manufacturing item
     * URL:: company/:companyUniqueName/stock/:stockUniqueName/manufacture/:manufacturingUniqueName
     */
    ManufacturingService.prototype.UpdateManufacturingItem = function (model, reqModal) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.put(this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.UPDATE.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)).replace(':stockUniqueName', reqModal.stockUniqueName).replace(':manufacturingUniqueName', reqModal.manufacturingUniqueName), model).map(function (res) {
            var data = res.json();
            data.request = model;
            data.queryString = reqModal;
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e, model); });
    };
    /**
     * Delete manufacturing item
     * URL:: company/:companyUniqueName/stock/:stockUniqueName/manufacture/:manufacturingUniqueName
     */
    ManufacturingService.prototype.DeleteManufacturingItem = function (model) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.delete(this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.DELETE.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)).replace(':stockUniqueName', encodeURIComponent(model.stockUniqueName)).replace(':manufacturingUniqueName', model.manufacturingUniqueName)).map(function (res) {
            var data = res.json();
            data.request = '';
            data.queryString = { model: model };
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e, '', { model: model }); });
    };
    /**
     * get manufacturing report details
     * URL:: company/:companyUniqueName/stock/manufacture-report
     */
    ManufacturingService.prototype.GetMfReport = function (model) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        // create url conditionally
        var url = this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.MF_REPORT;
        if ((model.product)) {
            url = url + 'product=' + model.product + '&';
        }
        if ((model.searchBy)) {
            url = url + 'searchBy=' + model.searchBy + '&';
        }
        if ((model.searchOperation)) {
            url = url + 'searchOperation=' + model.searchOperation + '&';
        }
        if ((model.searchValue)) {
            url = url + 'searchValue=' + model.searchValue + '&';
        }
        if ((model.from)) {
            url = url + 'from=' + model.from + '&';
        }
        if ((model.to)) {
            url = url + 'to=' + model.to + '&';
        }
        if ((model.page)) {
            url = url + 'page=' + model.page + '&';
        }
        if ((model.count)) {
            url = url + 'count=' + model.count;
        }
        return this._http.get(url.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)))
            .map(function (res) {
            var data = res.json();
            data.request = model;
            data.queryString = model;
            return data;
        })
            .catch(function (e) { return _this.errorHandler.HandleCatch(e, model); });
    };
    /**
     * get stock with rate
     * URL:: /company/:companyUniqueName/stock/:stockUniqueName/link-with-rates
     */
    ManufacturingService.prototype.GetStockWithRate = function (model) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.get(this.config.apiUrl + manufacturing_api_1.MANUFACTURING_API.GET_STOCK_WITH_RATE.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)).replace(':stockUniqueName', encodeURIComponent(model.stockUniqueName)))
            .map(function (res) {
            var data = res.json();
            data.queryString = model;
            return data;
        })
            .catch(function (e) { return _this.errorHandler.HandleCatch(e, ''); });
    };
    return ManufacturingService;
}());
ManufacturingService = __decorate([
    core_1.Injectable(),
    __param(3, core_1.Optional()), __param(3, core_1.Inject(service_config_1.ServiceConfig)),
    __metadata("design:paramtypes", [catchmanger_1.ErrorHandler, httpWrapper_service_1.HttpWrapperService, general_service_1.GeneralService, Object])
], ManufacturingService);
exports.ManufacturingService = ManufacturingService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFudWZhY3R1cmluZy5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibWFudWZhY3R1cmluZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkRBQTJEO0FBQzNELHNDQUE2RDtBQUc3RCwwREFBMEQ7QUFDMUQsaUVBQWdFO0FBR2hFLHFEQUFtRDtBQUNuRCxtREFBcUU7QUFHckUsSUFBYSxvQkFBb0I7SUFLL0IsOEJBQW9CLFlBQTBCLEVBQVUsS0FBeUIsRUFBVSxlQUErQixFQUM3RSxNQUEwQjtRQURuRCxpQkFBWSxHQUFaLFlBQVksQ0FBYztRQUFVLFVBQUssR0FBTCxLQUFLLENBQW9CO1FBQVUsb0JBQWUsR0FBZixlQUFlLENBQWdCO1FBQzdFLFdBQU0sR0FBTixNQUFNLENBQW9CO0lBQ3ZFLENBQUM7SUFFRDs7O09BR0c7SUFDSSxtREFBb0IsR0FBM0IsVUFBNEIsS0FBK0I7UUFBM0QsaUJBVUM7UUFUQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO1FBQ3RDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDO1FBQ2hFLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxxQ0FBaUIsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLGtCQUFrQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQywwQkFBMEIsRUFBRSxLQUFLLENBQUMsdUJBQXVCLENBQUMsQ0FBQzthQUNsUixHQUFHLENBQUMsVUFBQyxHQUFHO1lBQ1AsSUFBSSxJQUFJLEdBQTJELEdBQUcsQ0FBQyxJQUFJ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LENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLGtCQUFrQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO2FBQy9OLEdBQUcsQ0FBQyxVQUFDLEdBQUc7WUFDUCxJQUFJLElBQUksR0FBMkQsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQzlFLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQ3pCLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDZCxDQUFDLENBQUM7YUFDRCxLQUFLLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxLQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBMkMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUE5RSxDQUE4RSxDQUFDLENBQUM7SUFDbEcsQ0FBQztJQUNILDJCQUFDO0FBQUQsQ0FBQyxBQWxJRCxJQWtJQztBQWxJWSxvQkFBb0I7SUFEaEMsaUJBQVUsRUFBRTtJQU9SLFdBQUEsZUFBUSxFQUFFLENBQUEsRUFBRSxXQUFBLGFBQU0sQ0FBQyw4QkFBYSxDQUFDLENBQUE7cUNBREYsMEJBQVksRUFBaUIsd0NBQWtCLEVBQTJCLGdDQUFjO0dBTC9HLG9CQUFvQixDQWtJaEM7QUFsSVksb0RBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMvT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBIdHRwV3JhcHBlclNlcnZpY2UgfSBmcm9tICcuL2h0dHBXcmFwcGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSwgT3B0aW9uYWwsIEluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVXNlckRldGFpbHMgfSBmcm9tICcuLi9tb2RlbHMvYXBpLW1vZGVscy9sb2dpbk1vZGVscyc7XG5pbXBvcnQgeyBCYXNlUmVzcG9uc2UgfSBmcm9tICcuLi9tb2RlbHMvYXBpLW1vZGVscy9CYXNlUmVzcG9uc2UnO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9jYXRjaE1hbmFnZXIvY2F0Y2htYW5nZXInO1xuaW1wb3J0IHsgTUFOVUZBQ1RVUklOR19BUEkgfSBmcm9tICcuL2FwaXVybHMvbWFudWZhY3R1cmluZy5hcGknO1xuaW1wb3J0IHsgSUNvbW1vblJlc3BvbnNlT2ZNYW51ZmFjdHVyZUl0ZW0sIElNYW51ZmFjdHVyaW5nSXRlbVJlcXVlc3QsIElNYW51ZmFjdHVyaW5nVW5xSXRlbU9iaiwgSU1mU3RvY2tTZWFyY2hSZXF1ZXN0IH0gZnJvbSAnLi4vbW9kZWxzL2ludGVyZmFjZXMvbWFudWZhY3R1cmluZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgU3RvY2tzUmVzcG9uc2UgfSBmcm9tICcuLi9tb2RlbHMvYXBpLW1vZGVscy9JbnZlbnRvcnknO1xuaW1wb3J0IHsgR2VuZXJhbFNlcnZpY2UgfSBmcm9tICcuL2dlbmVyYWwuc2VydmljZSc7XG5pbXBvcnQgeyBTZXJ2aWNlQ29uZmlnLCBJU2VydmljZUNvbmZpZ0FyZ3MgfSBmcm9tICcuL3NlcnZpY2UuY29uZmlnJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIE1hbnVmYWN0dXJpbmdTZXJ2aWNlIHtcblxuICBwcml2YXRlIHVzZXI6IFVzZXJEZXRhaWxzO1xuICBwcml2YXRlIGNvbXBhbnlVbmlxdWVOYW1lOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlcnJvckhhbmRsZXI6IEVycm9ySGFuZGxlciwgcHJpdmF0ZSBfaHR0cDogSHR0cFdyYXBwZXJTZXJ2aWNlLCBwcml2YXRlIF9nZW5lcmFsU2VydmljZTogR2VuZXJhbFNlcnZpY2UsXG4gICAgQE9wdGlvbmFsKCkgQEluamVjdChTZXJ2aWNlQ29uZmlnKSBwcml2YXRlIGNvbmZpZzogSVNlcnZpY2VDb25maWdBcmdzKSB7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IG1hbnVmYWN0dXJpbmcgaXRlbSBkZXRhaWxzXG4gICAqIFVSTDo6IGNvbXBhbnkvOmNvbXBhbnlVbmlxdWVOYW1lL3N0b2NrLzpzdG9ja1VuaXF1ZU5hbWUvbWFudWZhY3R1cmUvOm1hbnVmYWN0dXJpbmdVbmlxdWVOYW1lXG4gICAqL1xuICBwdWJsaWMgR2V0TWFudWZhY3R1cmluZ0l0ZW0obW9kZWw6IElNYW51ZmFjdHVyaW5nVW5xSXRlbU9iaik6IE9ic2VydmFibGU8QmFzZVJlc3BvbnNlPElDb21tb25SZXNwb25zZU9mTWFudWZhY3R1cmVJdGVtLCBzdHJpbmc+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuY29uZmlnLmFwaVVybCArIE1BTlVGQUNUVVJJTkdfQVBJLkdFVC5yZXBsYWNlKCc6Y29tcGFueVVuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQodGhpcy5jb21wYW55VW5pcXVlTmFtZSkpLnJlcGxhY2UoJzpzdG9ja1VuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQobW9kZWwuc3RvY2tVbmlxdWVOYW1lKSkucmVwbGFjZSgnOm1hbnVmYWN0dXJpbmdVbmlxdWVOYW1lJywgbW9kZWwubWFudWZhY3R1cmluZ1VuaXF1ZU5hbWUpKVxuICAgICAgLm1hcCgocmVzKSA9PiB7XG4gICAgICAgIGxldCBkYXRhOiBCYXNlUmVzcG9uc2U8SUNvbW1vblJlc3BvbnNlT2ZNYW51ZmFjdHVyZUl0ZW0sIHN0cmluZz4gPSByZXMuanNvbigpO1xuICAgICAgICBkYXRhLnF1ZXJ5U3RyaW5nID0gbW9kZWw7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8SUNvbW1vblJlc3BvbnNlT2ZNYW51ZmFjdHVyZUl0ZW0sIHN0cmluZz4oZSwgJycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBjcmVhdGUgbWFudWZhY3R1cmluZyBpdGVtXG4gICAqIFVSTDo6IGNvbXBhbnkvOmNvbXBhbnlVbmlxdWVOYW1lL3N0b2NrLzpzdG9ja1VuaXF1ZU5hbWUvbWFudWZhY3R1cmVcbiAgICogZ2V0IHJlc3Vlc3QgbW9kZWwgYW5kIHN0b2NrIHVuaXF1ZW5hbWVcbiAgICovXG4gIHB1YmxpYyBDcmVhdGVNYW51ZmFjdHVyaW5nSXRlbShtb2RlbDogSU1hbnVmYWN0dXJpbmdJdGVtUmVxdWVzdCwgc3RvY2tVbmlxdWVOYW1lOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEJhc2VSZXNwb25zZTxJQ29tbW9uUmVzcG9uc2VPZk1hbnVmYWN0dXJlSXRlbSwgSU1hbnVmYWN0dXJpbmdJdGVtUmVxdWVzdD4+IHtcbiAgICB0aGlzLnVzZXIgPSB0aGlzLl9nZW5lcmFsU2VydmljZS51c2VyO1xuICAgIHRoaXMuY29tcGFueVVuaXF1ZU5hbWUgPSB0aGlzLl9nZW5lcmFsU2VydmljZS5jb21wYW55VW5pcXVlTmFtZTtcbiAgICByZXR1cm4gdGhpcy5faHR0cC5wb3N0KHRoaXMuY29uZmlnLmFwaVVybCArIE1BTlVGQUNUVVJJTkdfQVBJLkNSRUFURS5yZXBsYWNlKCc6Y29tcGFueVVuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQodGhpcy5jb21wYW55VW5pcXVlTmFtZSkpLnJlcGxhY2UoJzpzdG9ja1VuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQoc3RvY2tVbmlxdWVOYW1lKSksIG1vZGVsKS5tYXAoKHJlcykgPT4ge1xuICAgICAgbGV0IGRhdGE6IEJhc2VSZXNwb25zZTxJQ29tbW9uUmVzcG9uc2VPZk1hbnVmYWN0dXJlSXRlbSwgSU1hbnVmYWN0dXJpbmdJdGVtUmVxdWVzdD4gPSByZXMuanNvbigpO1xuICAgICAgZGF0YS5yZXF1ZXN0ID0gbW9kZWw7XG4gICAgICBkYXRhLnF1ZXJ5U3RyaW5nID0ge3N0b2NrVW5pcXVlTmFtZX07XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KS5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8SUNvbW1vblJlc3BvbnNlT2ZNYW51ZmFjdHVyZUl0ZW0sIElNYW51ZmFjdHVyaW5nSXRlbVJlcXVlc3Q+KGUsIG1vZGVsKSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIG1hbnVmYWN0dXJpbmcgaXRlbVxuICAgKiBVUkw6OiBjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9zdG9jay86c3RvY2tVbmlxdWVOYW1lL21hbnVmYWN0dXJlLzptYW51ZmFjdHVyaW5nVW5pcXVlTmFtZVxuICAgKi9cbiAgcHVibGljIFVwZGF0ZU1hbnVmYWN0dXJpbmdJdGVtKG1vZGVsOiBJTWFudWZhY3R1cmluZ0l0ZW1SZXF1ZXN0LCByZXFNb2RhbDogSU1hbnVmYWN0dXJpbmdVbnFJdGVtT2JqKTogT2JzZXJ2YWJsZTxCYXNlUmVzcG9uc2U8SUNvbW1vblJlc3BvbnNlT2ZNYW51ZmFjdHVyZUl0ZW0sIElNYW51ZmFjdHVyaW5nSXRlbVJlcXVlc3Q+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgcmV0dXJuIHRoaXMuX2h0dHAucHV0KHRoaXMuY29uZmlnLmFwaVVybCArIE1BTlVGQUNUVVJJTkdfQVBJLlVQREFURS5yZXBsYWNlKCc6Y29tcGFueVVuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQodGhpcy5jb21wYW55VW5pcXVlTmFtZSkpLnJlcGxhY2UoJzpzdG9ja1VuaXF1ZU5hbWUnLCByZXFNb2RhbC5zdG9ja1VuaXF1ZU5hbWUpLnJlcGxhY2UoJzptYW51ZmFjdHVyaW5nVW5pcXVlTmFtZScsIHJlcU1vZGFsLm1hbnVmYWN0dXJpbmdVbmlxdWVOYW1lKSwgbW9kZWwpLm1hcCgocmVzKSA9PiB7XG4gICAgICBsZXQgZGF0YTogQmFzZVJlc3BvbnNlPElDb21tb25SZXNwb25zZU9mTWFudWZhY3R1cmVJdGVtLCBJTWFudWZhY3R1cmluZ0l0ZW1SZXF1ZXN0PiA9IHJlcy5qc29uKCk7XG4gICAgICBkYXRhLnJlcXVlc3QgPSBtb2RlbDtcbiAgICAgIGRhdGEucXVlcnlTdHJpbmcgPSByZXFNb2RhbDtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pLmNhdGNoKChlKSA9PiB0aGlzLmVycm9ySGFuZGxlci5IYW5kbGVDYXRjaDxJQ29tbW9uUmVzcG9uc2VPZk1hbnVmYWN0dXJlSXRlbSwgSU1hbnVmYWN0dXJpbmdJdGVtUmVxdWVzdD4oZSwgbW9kZWwpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgbWFudWZhY3R1cmluZyBpdGVtXG4gICAqIFVSTDo6IGNvbXBhbnkvOmNvbXBhbnlVbmlxdWVOYW1lL3N0b2NrLzpzdG9ja1VuaXF1ZU5hbWUvbWFudWZhY3R1cmUvOm1hbnVmYWN0dXJpbmdVbmlxdWVOYW1lXG4gICAqL1xuICBwdWJsaWMgRGVsZXRlTWFudWZhY3R1cmluZ0l0ZW0obW9kZWw6IElNYW51ZmFjdHVyaW5nVW5xSXRlbU9iaik6IE9ic2VydmFibGU8QmFzZVJlc3BvbnNlPHN0cmluZywgc3RyaW5nPj4ge1xuICAgIHRoaXMudXNlciA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLnVzZXI7XG4gICAgdGhpcy5jb21wYW55VW5pcXVlTmFtZSA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLmNvbXBhbnlVbmlxdWVOYW1lO1xuICAgIHJldHVybiB0aGlzLl9odHRwLmRlbGV0ZSh0aGlzLmNvbmZpZy5hcGlVcmwgKyBNQU5VRkFDVFVSSU5HX0FQSS5ERUxFVEUucmVwbGFjZSgnOmNvbXBhbnlVbmlxdWVOYW1lJywgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY29tcGFueVVuaXF1ZU5hbWUpKS5yZXBsYWNlKCc6c3RvY2tVbmlxdWVOYW1lJywgZW5jb2RlVVJJQ29tcG9uZW50KG1vZGVsLnN0b2NrVW5pcXVlTmFtZSkpLnJlcGxhY2UoJzptYW51ZmFjdHVyaW5nVW5pcXVlTmFtZScsIG1vZGVsLm1hbnVmYWN0dXJpbmdVbmlxdWVOYW1lKSkubWFwKChyZXMpID0+IHtcbiAgICAgIGxldCBkYXRhOiBCYXNlUmVzcG9uc2U8c3RyaW5nLCBzdHJpbmc+ID0gcmVzLmpzb24oKTtcbiAgICAgIGRhdGEucmVxdWVzdCA9ICcnO1xuICAgICAgZGF0YS5xdWVyeVN0cmluZyA9IHttb2RlbH07XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KS5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8c3RyaW5nLCBzdHJpbmc+KGUsICcnLCB7bW9kZWx9KSk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IG1hbnVmYWN0dXJpbmcgcmVwb3J0IGRldGFpbHNcbiAgICogVVJMOjogY29tcGFueS86Y29tcGFueVVuaXF1ZU5hbWUvc3RvY2svbWFudWZhY3R1cmUtcmVwb3J0XG4gICAqL1xuICBwdWJsaWMgR2V0TWZSZXBvcnQobW9kZWw6IElNZlN0b2NrU2VhcmNoUmVxdWVzdCk6IE9ic2VydmFibGU8QmFzZVJlc3BvbnNlPFN0b2Nrc1Jlc3BvbnNlLCBJTWZTdG9ja1NlYXJjaFJlcXVlc3Q+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgLy8gY3JlYXRlIHVybCBjb25kaXRpb25hbGx5XG4gICAgbGV0IHVybCA9IHRoaXMuY29uZmlnLmFwaVVybCArIE1BTlVGQUNUVVJJTkdfQVBJLk1GX1JFUE9SVDtcbiAgICBpZiAoKG1vZGVsLnByb2R1Y3QpKSB7XG4gICAgICB1cmwgPSB1cmwgKyAncHJvZHVjdD0nICsgbW9kZWwucHJvZHVjdCArICcmJztcbiAgICB9XG4gICAgaWYgKChtb2RlbC5zZWFyY2hCeSkpIHtcbiAgICAgIHVybCA9IHVybCArICdzZWFyY2hCeT0nICsgbW9kZWwuc2VhcmNoQnkgKyAnJic7XG4gICAgfVxuICAgIGlmICgobW9kZWwuc2VhcmNoT3BlcmF0aW9uKSkge1xuICAgICAgdXJsID0gdXJsICsgJ3NlYXJjaE9wZXJhdGlvbj0nICsgbW9kZWwuc2VhcmNoT3BlcmF0aW9uICsgJyYnO1xuICAgIH1cbiAgICBpZiAoKG1vZGVsLnNlYXJjaFZhbHVlKSkge1xuICAgICAgdXJsID0gdXJsICsgJ3NlYXJjaFZhbHVlPScgKyBtb2RlbC5zZWFyY2hWYWx1ZSArICcmJztcbiAgICB9XG4gICAgaWYgKChtb2RlbC5mcm9tKSkge1xuICAgICAgdXJsID0gdXJsICsgJ2Zyb209JyArIG1vZGVsLmZyb20gKyAnJic7XG4gICAgfVxuICAgIGlmICgobW9kZWwudG8pKSB7XG4gICAgICB1cmwgPSB1cmwgKyAndG89JyArIG1vZGVsLnRvICsgJyYnO1xuICAgIH1cbiAgICBpZiAoKG1vZGVsLnBhZ2UpKSB7XG4gICAgICB1cmwgPSB1cmwgKyAncGFnZT0nICsgbW9kZWwucGFnZSArICcmJztcbiAgICB9XG4gICAgaWYgKChtb2RlbC5jb3VudCkpIHtcbiAgICAgIHVybCA9IHVybCArICdjb3VudD0nICsgbW9kZWwuY291bnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHVybC5yZXBsYWNlKCc6Y29tcGFueVVuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQodGhpcy5jb21wYW55VW5pcXVlTmFtZSkpKVxuICAgICAgLm1hcCgocmVzKSA9PiB7XG4gICAgICAgIGxldCBkYXRhOiBCYXNlUmVzcG9uc2U8U3RvY2tzUmVzcG9uc2UsIElNZlN0b2NrU2VhcmNoUmVxdWVzdD4gPSByZXMuanNvbigpO1xuICAgICAgICBkYXRhLnJlcXVlc3QgPSBtb2RlbDtcbiAgICAgICAgZGF0YS5xdWVyeVN0cmluZyA9IG1vZGVsO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGUpID0+IHRoaXMuZXJyb3JIYW5kbGVyLkhhbmRsZUNhdGNoPFN0b2Nrc1Jlc3BvbnNlLCBJTWZTdG9ja1NlYXJjaFJlcXVlc3Q+KGUsIG1vZGVsKSk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IHN0b2NrIHdpdGggcmF0ZVxuICAgKiBVUkw6OiAvY29tcGFueS86Y29tcGFueVVuaXF1ZU5hbWUvc3RvY2svOnN0b2NrVW5pcXVlTmFtZS9saW5rLXdpdGgtcmF0ZXNcbiAgICovXG4gIHB1YmxpYyBHZXRTdG9ja1dpdGhSYXRlKG1vZGVsOiBJTWFudWZhY3R1cmluZ1VucUl0ZW1PYmopOiBPYnNlcnZhYmxlPEJhc2VSZXNwb25zZTxJQ29tbW9uUmVzcG9uc2VPZk1hbnVmYWN0dXJlSXRlbSwgc3RyaW5nPj4ge1xuICAgIHRoaXMudXNlciA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLnVzZXI7XG4gICAgdGhpcy5jb21wYW55VW5pcXVlTmFtZSA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLmNvbXBhbnlVbmlxdWVOYW1lO1xuICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmNvbmZpZy5hcGlVcmwgKyBNQU5VRkFDVFVSSU5HX0FQSS5HRVRfU1RPQ0tfV0lUSF9SQVRFLnJlcGxhY2UoJzpjb21wYW55VW5pcXVlTmFtZScsIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmNvbXBhbnlVbmlxdWVOYW1lKSkucmVwbGFjZSgnOnN0b2NrVW5pcXVlTmFtZScsIGVuY29kZVVSSUNvbXBvbmVudChtb2RlbC5zdG9ja1VuaXF1ZU5hbWUpKSlcbiAgICAgIC5tYXAoKHJlcykgPT4ge1xuICAgICAgICBsZXQgZGF0YTogQmFzZVJlc3BvbnNlPElDb21tb25SZXNwb25zZU9mTWFudWZhY3R1cmVJdGVtLCBzdHJpbmc+ID0gcmVzLmpzb24oKTtcbiAgICAgICAgZGF0YS5xdWVyeVN0cmluZyA9IG1vZGVsO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGUpID0+IHRoaXMuZXJyb3JIYW5kbGVyLkhhbmRsZUNhdGNoPElDb21tb25SZXNwb25zZU9mTWFudWZhY3R1cmVJdGVtLCBzdHJpbmc+KGUsICcnKSk7XG4gIH1cbn1cbiJdfQ==