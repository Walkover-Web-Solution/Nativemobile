"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var httpWrapper_service_1 = require("./httpWrapper.service");
var core_1 = require("@angular/core");
var catchmanger_1 = require("./catchManager/catchmanger");
var settings_financial_year_api_1 = require("./apiurls/settings.financial-year.api");
var general_service_1 = require("./general.service");
var service_config_1 = require("./service.config");
var SettingsFinancialYearService = (function () {
    function SettingsFinancialYearService(errorHandler, _http, _generalService, config) {
        this.errorHandler = errorHandler;
        this._http = _http;
        this._generalService = _generalService;
        this.config = config;
    }
    /*
    * Get All Financial Years
    * API: 'company/:companyUniqueName/financial-year'
    * Method: GET
    */
    SettingsFinancialYearService.prototype.GetAllFinancialYears = function () {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.get(this.config.apiUrl + settings_financial_year_api_1.SETTINGS_FINANCIAL_YEAR_API.GET_ALL_FINANCIAL_YEARS.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName))).map(function (res) {
            var data = res.json();
            data.queryString = {};
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e); });
    };
    /*
    * Lock Financial Year
    * API: 'company/:companyUniqueName/financial-year-lock'
    * Method: PATCH
    */
    SettingsFinancialYearService.prototype.LockFinancialYear = function (reqObj) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.patch(this.config.apiUrl + settings_financial_year_api_1.SETTINGS_FINANCIAL_YEAR_API.LOCK_FINANCIAL_YEAR.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)), reqObj).map(function (res) {
            var data = res.json();
            data.queryString = {};
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e); });
    };
    /*
    * Unlock Financial Year
    * API: 'company/:companyUniqueName/financial-year-unlock'
    * Method: PATCH
    */
    SettingsFinancialYearService.prototype.UnlockFinancialYear = function (reqObj) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.patch(this.config.apiUrl + settings_financial_year_api_1.SETTINGS_FINANCIAL_YEAR_API.UNLOCK_FINANCIAL_YEAR.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)), reqObj).map(function (res) {
            var data = res.json();
            data.queryString = {};
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e); });
    };
    /*
    * Switch Financial Year
    * API: 'company/:companyUniqueName/financial-year-unlock'
    * Method: PATCH
    */
    SettingsFinancialYearService.prototype.SwitchFinancialYear = function (uniqueName) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.patch(this.config.apiUrl + settings_financial_year_api_1.SETTINGS_FINANCIAL_YEAR_API.SWITCH_FINANCIAL_YEAR.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)), { uniqueName: uniqueName }).map(function (res) {
            var data = res.json();
            data.queryString = {};
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e); });
    };
    /*
    * Add Financial Year
    * API: 'company/:companyUniqueName/financial-year'
    * Method: PATCH
    */
    SettingsFinancialYearService.prototype.AddFinancialYear = function (fromYear) {
        var _this = this;
        this.user = this._generalService.user;
        this.companyUniqueName = this._generalService.companyUniqueName;
        return this._http.post(this.config.apiUrl + settings_financial_year_api_1.SETTINGS_FINANCIAL_YEAR_API.ADD_FINANCIAL_YEAR.replace(':companyUniqueName', encodeURIComponent(this.companyUniqueName)), { fromYear: fromYear }).map(function (res) {
            var data = res.json();
            data.queryString = {};
            return data;
        }).catch(function (e) { return _this.errorHandler.HandleCatch(e); });
    };
    return SettingsFinancialYearService;
}());
SettingsFinancialYearService = __decorate([
    core_1.Injectable(),
    __param(3, core_1.Optional()), __param(3, core_1.Inject(service_config_1.ServiceConfig)),
    __metadata("design:paramtypes", [catchmanger_1.ErrorHandler, httpWrapper_service_1.HttpWrapperService,
        general_service_1.GeneralService, Object])
], SettingsFinancialYearService);
exports.SettingsFinancialYearService = SettingsFinancialYearService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZ3MuZmluYW5jaWFsLXllYXIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNldHRpbmdzLmZpbmFuY2lhbC15ZWFyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2REFBMkQ7QUFDM0Qsc0NBQTZEO0FBRzdELDBEQUEwRDtBQUMxRCxxRkFBb0Y7QUFFcEYscURBQW1EO0FBQ25ELG1EQUFxRTtBQWNyRSxJQUFhLDRCQUE0QjtJQUt2QyxzQ0FBb0IsWUFBMEIsRUFBVSxLQUF5QixFQUM3RCxlQUErQixFQUE2QyxNQUEwQjtRQUR0RyxpQkFBWSxHQUFaLFlBQVksQ0FBYztRQUFVLFVBQUssR0FBTCxLQUFLLENBQW9CO1FBQzdELG9CQUFlLEdBQWYsZUFBZSxDQUFnQjtRQUE2QyxXQUFNLEdBQU4sTUFBTSxDQUFvQjtJQUMxSCxDQUFDO0lBRUQ7Ozs7TUFJRTtJQUNLLDJEQUFvQixHQUEzQjtRQUFBLGlCQVFDO1FBUEMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztRQUN0QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQztRQUNoRSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcseURBQTJCLENBQUMsdUJBQXVCLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLGtCQUFrQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxHQUFHO1lBQ2hMLElBQUksSUFBSSxHQUFpRCxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDcEUsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7WUFDdEIsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNkLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FB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Q0FBYztHQU54Qyw0QkFBNEIsQ0FtRnhDO0FBbkZZLG9FQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL09ic2VydmFibGUnO1xuaW1wb3J0IHsgSHR0cFdyYXBwZXJTZXJ2aWNlIH0gZnJvbSAnLi9odHRwV3JhcHBlci5zZXJ2aWNlJztcbmltcG9ydCB7IEluamVjdGFibGUsIE9wdGlvbmFsLCBJbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFVzZXJEZXRhaWxzIH0gZnJvbSAnLi4vbW9kZWxzL2FwaS1tb2RlbHMvbG9naW5Nb2RlbHMnO1xuaW1wb3J0IHsgQmFzZVJlc3BvbnNlIH0gZnJvbSAnLi4vbW9kZWxzL2FwaS1tb2RlbHMvQmFzZVJlc3BvbnNlJztcbmltcG9ydCB7IEVycm9ySGFuZGxlciB9IGZyb20gJy4vY2F0Y2hNYW5hZ2VyL2NhdGNobWFuZ2VyJztcbmltcG9ydCB7IFNFVFRJTkdTX0ZJTkFOQ0lBTF9ZRUFSX0FQSSB9IGZyb20gJy4vYXBpdXJscy9zZXR0aW5ncy5maW5hbmNpYWwteWVhci5hcGknO1xuaW1wb3J0IHsgQWN0aXZlRmluYW5jaWFsWWVhciB9IGZyb20gJy4uL21vZGVscy9hcGktbW9kZWxzL0NvbXBhbnknO1xuaW1wb3J0IHsgR2VuZXJhbFNlcnZpY2UgfSBmcm9tICcuL2dlbmVyYWwuc2VydmljZSc7XG5pbXBvcnQgeyBTZXJ2aWNlQ29uZmlnLCBJU2VydmljZUNvbmZpZ0FyZ3MgfSBmcm9tICcuL3NlcnZpY2UuY29uZmlnJztcblxuZXhwb3J0IGludGVyZmFjZSBJTG9ja0ZpbmFuY2lhbFllYXJSZXF1ZXN0IHtcbiAgbG9ja0FsbDogYm9vbGVhbjtcbiAgdW5pcXVlTmFtZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElGaW5hbmNpYWxZZWFyUmVzcG9uc2Uge1xuICBjb21wYW55TmFtZTogc3RyaW5nO1xuICBjb21wYW55VW5pcXVlTmFtZTogc3RyaW5nO1xuICBmaW5hbmNpYWxZZWFyczogQWN0aXZlRmluYW5jaWFsWWVhcltdO1xufVxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NGaW5hbmNpYWxZZWFyU2VydmljZSB7XG5cbiAgcHJpdmF0ZSB1c2VyOiBVc2VyRGV0YWlscztcbiAgcHJpdmF0ZSBjb21wYW55VW5pcXVlTmFtZTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZXJyb3JIYW5kbGVyOiBFcnJvckhhbmRsZXIsIHByaXZhdGUgX2h0dHA6IEh0dHBXcmFwcGVyU2VydmljZSxcbiAgICAgICAgICAgICAgcHJpdmF0ZSBfZ2VuZXJhbFNlcnZpY2U6IEdlbmVyYWxTZXJ2aWNlLCBAT3B0aW9uYWwoKSBASW5qZWN0KFNlcnZpY2VDb25maWcpIHByaXZhdGUgY29uZmlnOiBJU2VydmljZUNvbmZpZ0FyZ3MpIHtcbiAgfVxuXG4gIC8qXG4gICogR2V0IEFsbCBGaW5hbmNpYWwgWWVhcnNcbiAgKiBBUEk6ICdjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9maW5hbmNpYWwteWVhcidcbiAgKiBNZXRob2Q6IEdFVFxuICAqL1xuICBwdWJsaWMgR2V0QWxsRmluYW5jaWFsWWVhcnMoKTogT2JzZXJ2YWJsZTxCYXNlUmVzcG9uc2U8SUZpbmFuY2lhbFllYXJSZXNwb25zZSwgc3RyaW5nPj4ge1xuICAgIHRoaXMudXNlciA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLnVzZXI7XG4gICAgdGhpcy5jb21wYW55VW5pcXVlTmFtZSA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLmNvbXBhbnlVbmlxdWVOYW1lO1xuICAgIHJldHVybiB0aGlzLl9odHRwLmdldCh0aGlzLmNvbmZpZy5hcGlVcmwgKyBTRVRUSU5HU19GSU5BTkNJQUxfWUVBUl9BUEkuR0VUX0FMTF9GSU5BTkNJQUxfWUVBUlMucmVwbGFjZSgnOmNvbXBhbnlVbmlxdWVOYW1lJywgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY29tcGFueVVuaXF1ZU5hbWUpKSkubWFwKChyZXMpID0+IHtcbiAgICAgIGxldCBkYXRhOiBCYXNlUmVzcG9uc2U8SUZpbmFuY2lhbFllYXJSZXNwb25zZSwgc3RyaW5nPiA9IHJlcy5qc29uKCk7XG4gICAgICBkYXRhLnF1ZXJ5U3RyaW5nID0ge307XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KS5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8SUZpbmFuY2lhbFllYXJSZXNwb25zZSwgc3RyaW5nPihlKSk7XG4gIH1cblxuICAvKlxuICAqIExvY2sgRmluYW5jaWFsIFllYXJcbiAgKiBBUEk6ICdjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9maW5hbmNpYWwteWVhci1sb2NrJ1xuICAqIE1ldGhvZDogUEFUQ0hcbiAgKi9cbiAgcHVibGljIExvY2tGaW5hbmNpYWxZZWFyKHJlcU9iajogSUxvY2tGaW5hbmNpYWxZZWFyUmVxdWVzdCk6IE9ic2VydmFibGU8QmFzZVJlc3BvbnNlPElGaW5hbmNpYWxZZWFyUmVzcG9uc2UsIElMb2NrRmluYW5jaWFsWWVhclJlcXVlc3Q+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgcmV0dXJuIHRoaXMuX2h0dHAucGF0Y2godGhpcy5jb25maWcuYXBpVXJsICsgU0VUVElOR1NfRklOQU5DSUFMX1lFQVJfQVBJLkxPQ0tfRklOQU5DSUFMX1lFQVIucmVwbGFjZSgnOmNvbXBhbnlVbmlxdWVOYW1lJywgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY29tcGFueVVuaXF1ZU5hbWUpKSwgcmVxT2JqKS5tYXAoKHJlcykgPT4ge1xuICAgICAgbGV0IGRhdGE6IEJhc2VSZXNwb25zZTxJRmluYW5jaWFsWWVhclJlc3BvbnNlLCBJTG9ja0ZpbmFuY2lhbFllYXJSZXF1ZXN0PiA9IHJlcy5qc29uKCk7XG4gICAgICBkYXRhLnF1ZXJ5U3RyaW5nID0ge307XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KS5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8SUZpbmFuY2lhbFllYXJSZXNwb25zZSwgSUxvY2tGaW5hbmNpYWxZZWFyUmVxdWVzdD4oZSkpO1xuICB9XG5cbiAgLypcbiAgKiBVbmxvY2sgRmluYW5jaWFsIFllYXJcbiAgKiBBUEk6ICdjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9maW5hbmNpYWwteWVhci11bmxvY2snXG4gICogTWV0aG9kOiBQQVRDSFxuICAqL1xuICBwdWJsaWMgVW5sb2NrRmluYW5jaWFsWWVhcihyZXFPYmo6IElMb2NrRmluYW5jaWFsWWVhclJlcXVlc3QpOiBPYnNlcnZhYmxlPEJhc2VSZXNwb25zZTxJRmluYW5jaWFsWWVhclJlc3BvbnNlLCBJTG9ja0ZpbmFuY2lhbFllYXJSZXF1ZXN0Pj4ge1xuICAgIHRoaXMudXNlciA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLnVzZXI7XG4gICAgdGhpcy5jb21wYW55VW5pcXVlTmFtZSA9IHRoaXMuX2dlbmVyYWxTZXJ2aWNlLmNvbXBhbnlVbmlxdWVOYW1lO1xuICAgIHJldHVybiB0aGlzLl9odHRwLnBhdGNoKHRoaXMuY29uZmlnLmFwaVVybCArIFNFVFRJTkdTX0ZJTkFOQ0lBTF9ZRUFSX0FQSS5VTkxPQ0tfRklOQU5DSUFMX1lFQVIucmVwbGFjZSgnOmNvbXBhbnlVbmlxdWVOYW1lJywgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuY29tcGFueVVuaXF1ZU5hbWUpKSwgcmVxT2JqKS5tYXAoKHJlcykgPT4ge1xuICAgICAgbGV0IGRhdGE6IEJhc2VSZXNwb25zZTxJRmluYW5jaWFsWWVhclJlc3BvbnNlLCBJTG9ja0ZpbmFuY2lhbFllYXJSZXF1ZXN0PiA9IHJlcy5qc29uKCk7XG4gICAgICBkYXRhLnF1ZXJ5U3RyaW5nID0ge307XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KS5jYXRjaCgoZSkgPT4gdGhpcy5lcnJvckhhbmRsZXIuSGFuZGxlQ2F0Y2g8SUZpbmFuY2lhbFllYXJSZXNwb25zZSwgSUxvY2tGaW5hbmNpYWxZZWFyUmVxdWVzdD4oZSkpO1xuICB9XG5cbiAgLypcbiAgKiBTd2l0Y2ggRmluYW5jaWFsIFllYXJcbiAgKiBBUEk6ICdjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9maW5hbmNpYWwteWVhci11bmxvY2snXG4gICogTWV0aG9kOiBQQVRDSFxuICAqL1xuICBwdWJsaWMgU3dpdGNoRmluYW5jaWFsWWVhcih1bmlxdWVOYW1lOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEJhc2VSZXNwb25zZTxBY3RpdmVGaW5hbmNpYWxZZWFyLCBzdHJpbmc+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgcmV0dXJuIHRoaXMuX2h0dHAucGF0Y2godGhpcy5jb25maWcuYXBpVXJsICsgU0VUVElOR1NfRklOQU5DSUFMX1lFQVJfQVBJLlNXSVRDSF9GSU5BTkNJQUxfWUVBUi5yZXBsYWNlKCc6Y29tcGFueVVuaXF1ZU5hbWUnLCBlbmNvZGVVUklDb21wb25lbnQodGhpcy5jb21wYW55VW5pcXVlTmFtZSkpLCB7dW5pcXVlTmFtZX0pLm1hcCgocmVzKSA9PiB7XG4gICAgICBsZXQgZGF0YTogQmFzZVJlc3BvbnNlPEFjdGl2ZUZpbmFuY2lhbFllYXIsIHN0cmluZz4gPSByZXMuanNvbigpO1xuICAgICAgZGF0YS5xdWVyeVN0cmluZyA9IHt9O1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSkuY2F0Y2goKGUpID0+IHRoaXMuZXJyb3JIYW5kbGVyLkhhbmRsZUNhdGNoPEFjdGl2ZUZpbmFuY2lhbFllYXIsIHN0cmluZz4oZSkpO1xuICB9XG5cbiAgLypcbiAgKiBBZGQgRmluYW5jaWFsIFllYXJcbiAgKiBBUEk6ICdjb21wYW55Lzpjb21wYW55VW5pcXVlTmFtZS9maW5hbmNpYWwteWVhcidcbiAgKiBNZXRob2Q6IFBBVENIXG4gICovXG4gIHB1YmxpYyBBZGRGaW5hbmNpYWxZZWFyKGZyb21ZZWFyOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEJhc2VSZXNwb25zZTxJRmluYW5jaWFsWWVhclJlc3BvbnNlLCBzdHJpbmc+PiB7XG4gICAgdGhpcy51c2VyID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UudXNlcjtcbiAgICB0aGlzLmNvbXBhbnlVbmlxdWVOYW1lID0gdGhpcy5fZ2VuZXJhbFNlcnZpY2UuY29tcGFueVVuaXF1ZU5hbWU7XG4gICAgcmV0dXJuIHRoaXMuX2h0dHAucG9zdCh0aGlzLmNvbmZpZy5hcGlVcmwgKyBTRVRUSU5HU19GSU5BTkNJQUxfWUVBUl9BUEkuQUREX0ZJTkFOQ0lBTF9ZRUFSLnJlcGxhY2UoJzpjb21wYW55VW5pcXVlTmFtZScsIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmNvbXBhbnlVbmlxdWVOYW1lKSksIHtmcm9tWWVhcn0pLm1hcCgocmVzKSA9PiB7XG4gICAgICBsZXQgZGF0YTogQmFzZVJlc3BvbnNlPElGaW5hbmNpYWxZZWFyUmVzcG9uc2UsIHN0cmluZz4gPSByZXMuanNvbigpO1xuICAgICAgZGF0YS5xdWVyeVN0cmluZyA9IHt9O1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSkuY2F0Y2goKGUpID0+IHRoaXMuZXJyb3JIYW5kbGVyLkhhbmRsZUNhdGNoPElGaW5hbmNpYWxZZWFyUmVzcG9uc2UsIHN0cmluZz4oZSkpO1xuICB9XG59XG4iXX0=